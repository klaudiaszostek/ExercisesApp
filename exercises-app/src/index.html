<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Exercises App</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <h1>
      <img src="icon.ico" alt="App Icon" width="90" height="90" /> Time for
      training? <br /><br />
      <div>
        <button id="startWorkoutBtn">Start today's workout</button>
      </div>
      <button id="finish-btn" style="margin-top: 1rem">Mark as done</button>
      <br />
      <p id="completion-status" class="done-status"></p>
    </h1>
    <div id="alternate-workout" class="training-box">
      <h3>Choose Different Workout</h3>
      <select id="alternate-select">
        <option value="">-- Select a day --</option>
        <option value="Monday">Monday - STRENGTH</option>
        <option value="Tuesday">Tuesday - CARDIO</option>
        <option value="Wednesday">Wednesday - STRENGTH</option>
        <option value="Thursday">Thursday - REST OR WALK</option>
        <option value="Friday">Friday - STRENGTH</option>
        <option value="Saturday">Saturday - CARDIO</option>
        <option value="Sunday">Sunday - REST</option>
      </select>
      <button id="use-alternate">Do this one instead</button>
    </div>

    <div id="today-workout" class="training-box">
      <h3>Today's Workout</h3>
      <ul id="exercise-list">
        <li>Loading...</li>
      </ul>
    </div>

    <div id="history-box" class="training-box">
      <h3>Workout History</h3>
      <ul id="history-list">
        <li>Loading...</li>
      </ul>
    </div>

    <br />
    <div>
      <h3>TRAINING PLAN (3-4 days a week)</h3>
      <p>Sample weekly schedule:</p>
      <table>
        <tr>
          <th>Day</th>
          <th>Plan</th>
        </tr>
        <tr>
          <td>Monday</td>
          <td>STRENGTH TRAINING + ABS</td>
        </tr>
        <tr>
          <td>Tuesday</td>
          <td>CARDIO</td>
        </tr>
        <tr>
          <td>Wednesday</td>
          <td>STRENGTH TRAINING + ABS</td>
        </tr>
        <tr>
          <td>Thursday</td>
          <td>REST OR WALK</td>
        </tr>
        <tr>
          <td>Friday</td>
          <td>STRENGTH TRAINING + ABS</td>
        </tr>
        <tr>
          <td>Saturday</td>
          <td>CARDIO</td>
        </tr>
        <tr>
          <td>Sunday</td>
          <td>REST</td>
        </tr>
      </table>
    </div>

    <br />
    <div>
      <h3>How do you reconcile this with your studies?</h3>
      <p>
        üëç If you don't have a gym ‚Üí strength training at home with your own
        body weight
      </p>
      <p>
        üëç If you don't have time for cardio ‚Üí more walking (e.g. stairs instead
        of elevator, walk to university)
      </p>
    </div>
  </body>
  <script>
    const workouts = {
      Monday: [
        "STRENGTH TRAINING + ABS",
        "Bodyweight Squats (4x15)",
        "Lunges (4x12 each leg)",
        "Push-ups (3x10-15)",
        "Hip Thrusts (4x15)",
        "Plank with single arm row (3x12)",
        "Plank (3x40 sec)",
        "Leg Raises (3x15)",
        "Russian Twists (3x20)",
        "Bicycle Crunches (3x20)",
        "Reverse Crunches (3x15)",
      ],
      Tuesday: [
        "CARDIO",
        "Cycling (20-40 min: 2 min faster, 1 min slower intervals)",
        "OR Running (25-30 min steady pace OR 15-20 min intervals: 1 min faster, 2 min slower)",
        "OR Walking (8,000-10,000 steps)",
      ],
      Wednesday: [
        "STRENGTH TRAINING + ABS",
        "Bodyweight Squats (4x15)",
        "Lunges (4x12 each leg)",
        "Push-ups (3x10-15)",
        "Hip Thrusts (4x15)",
        "Plank with single arm row (3x12)",
        "Plank (3x40 sec)",
        "Leg Raises (3x15)",
        "Russian Twists (3x20)",
        "Bicycle Crunches (3x20)",
        "Reverse Crunches (3x15)",
      ],
      Thursday: ["REST OR WALK"],
      Friday: [
        "STRENGTH TRAINING + ABS",
        "Bodyweight Squats (4x15)",
        "Lunges (4x12 each leg)",
        "Push-ups (3x10-15)",
        "Hip Thrusts (4x15)",
        "Plank with single arm row (3x12)",
        "Plank (3x40 sec)",
        "Leg Raises (3x15)",
        "Russian Twists (3x20)",
        "Bicycle Crunches (3x20)",
        "Reverse Crunches (3x15)",
      ],
      Saturday: [
        "CARDIO",
        "Cycling (20-40 min: 2 min faster, 1 min slower intervals)",
        "OR Running (25-30 min steady pace OR 15-20 min intervals: 1 min faster, 2 min slower)",
        "OR Walking (8,000-10,000 steps)",
      ],
      Sunday: ["REST"],
    };

    function getTodayInfo() {
      const days = [
        "Sunday",
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday",
        "Saturday",
      ];
      const todayIndex = new Date().getDay();
      const today = days[todayIndex];
      const date = new Date().toISOString().split("T")[0];
      return { today, date };
    }

    document.getElementById("startWorkoutBtn").addEventListener("click", () => {
      const { today } = getTodayInfo();
      currentSelectedDay = today;
      window.open(
        `workout.html?day=${today}`,
        "_blank",
        "width=700,height=700"
      );
    });

    function showTodayWorkout() {
      const { today } = getTodayInfo();
      const list = document.getElementById("exercise-list");
      list.innerHTML = "";
      workouts[today].forEach((ex) => {
        const li = document.createElement("li");
        li.textContent = ex;
        list.appendChild(li);
      });
    }

    function showWorkoutFor(day) {
      const list = document.getElementById("exercise-list");
      list.innerHTML = "";
      workouts[day].forEach((ex) => {
        const li = document.createElement("li");
        li.textContent = ex;
        list.appendChild(li);
      });
    }

    document.getElementById("use-alternate").addEventListener("click", () => {
      const selectedDay = document.getElementById("alternate-select").value;
      if (!selectedDay) return;
      currentSelectedDay = selectedDay;
      showWorkoutFor(currentSelectedDay);
      window.open(
        `workout.html?day=${currentSelectedDay}`,
        "_blank",
        "width=700,height=700"
      );
    });

    async function loadWorkoutHistory() {
      const list = document.getElementById("history-list");
      const history = await window.dbAPI.getWorkouts();
      list.innerHTML = "";

      if (history.length === 0) {
        list.innerHTML = "<li>No workouts yet.</li>";
        return;
      }

      history.forEach((item) => {
        const li = document.createElement("li");
        li.textContent = `${item.date} ‚Äì ${item.type}`;
        list.appendChild(li);
      });

      checkIfWorkoutDone(history);
    }

    function checkIfWorkoutDone(history) {
      const { today, date } = getTodayInfo();
      const alreadyDone = history.some((entry) => entry.date === date);

      const finishBtn = document.getElementById("finish-btn");
      const status = document.getElementById("completion-status");

      if (alreadyDone) {
        finishBtn.style.display = "none";
        status.textContent = "‚úÖ Completed!";
      } else {
        finishBtn.style.display = "inline-block";
        status.textContent = "";
      }
    }

    async function finishWorkout() {
      const { date, today } = getTodayInfo();
      const selectedDay = currentSelectedDay || today;
      const workoutType = workouts[selectedDay][0] || "Unknown";

      const history = await window.dbAPI.getWorkouts();
      const alreadyDone = history.some((entry) => entry.date === date);
      if (alreadyDone) return;

      await window.dbAPI.addWorkout({
        date,
        day: selectedDay,
        type: workoutType,
      });

      loadWorkoutHistory();
    }

    document.addEventListener("DOMContentLoaded", () => {
      showTodayWorkout();
      loadWorkoutHistory();

      document
        .getElementById("finish-btn")
        .addEventListener("click", finishWorkout);
    });
  </script>
</html>
