<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Exercises App</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <h1>
      <img src="icon.ico" alt="App Icon" width="90" height="90" /> Time for
      training? <br /><br />
      <div>
        <button id="startWorkoutBtn">Start today's workout</button>
      </div>
      <button id="finish-btn" style="margin-top: 1rem">Mark as done</button>
      <br />
      <p id="completion-status" class="done-status"></p>
    </h1>

    <div id="today-workout" class="training-box">
      <h3>Today's Workout</h3>
      <ul id="exercise-list">
        <li>Loading...</li>
      </ul>
    </div>

    <div id="history-box" class="training-box">
      <h3>Workout History</h3>
      <ul id="history-list">
        <li>Loading...</li>
      </ul>
    </div>

    <br />
    <div>
      <h3>TRAINING PLAN (3-4 days a week)</h3>
      <p>Sample weekly schedule:</p>
      <table>
        <tr>
          <th>Day</th>
          <th>Plan</th>
        </tr>
        <tr>
          <td>Monday</td>
          <td>Strength training + abs</td>
        </tr>
        <tr>
          <td>Tuesday</td>
          <td>Cardio (fast walk / intervals)</td>
        </tr>
        <tr>
          <td>Wednesday</td>
          <td>Strength training + abs</td>
        </tr>
        <tr>
          <td>Thursday</td>
          <td>Off (possibly a walk)</td>
        </tr>
        <tr>
          <td>Friday</td>
          <td>Strength training + abs</td>
        </tr>
        <tr>
          <td>Saturday</td>
          <td>Optional cardio (bike, run, walk)</td>
        </tr>
        <tr>
          <td>Sunday</td>
          <td>Rest</td>
        </tr>
      </table>
    </div>

    <br />
    <div>
      <h3>How do you reconcile this with your studies?</h3>
      <p>üëç If you have a busy week ‚Üí 3 training days instead of 4</p>
      <p>
        üëç If you don't have a gym ‚Üí strength training at home with your own
        body weight
      </p>
      <p>
        üëç If you don't have time for cardio ‚Üí more walking (e.g. stairs instead
        of elevator, walk to university)
      </p>
    </div>
  </body>

  <script src="renderer.js"></script>
  <script>
    const workouts = {
      Monday: [
        "STRENGTH TRAINING + ABS",
        "Squats (4x12)",
        "Deadlift or Hip Thrust (4x10-12)",
        "Dumbbell Row / Pull-ups (3x10)",
        "Overhead Press (3x10)",
        "Plank (3x45 sec)",
        "Leg Raises (3x15)",
        "Russian Twists (3x20)",
      ],
      Tuesday: [
        "CARDIO",
        "Fast walk ‚Äì 8‚Äì10k steps",
        "OR Intervals: 30s sprint + 30s jog x10",
      ],
      Wednesday: [
        "STRENGTH TRAINING + ABS",
        "Squats (4x12)",
        "Deadlift or Hip Thrust (4x10-12)",
        "Dumbbell Row / Pull-ups (3x10)",
        "Overhead Press (3x10)",
        "Plank (3x45 sec)",
        "Leg Raises (3x15)",
        "Russian Twists (3x20)",
      ],
      Thursday: ["REST OR WALK"],
      Friday: [
        "STRENGTH TRAINING + ABS",
        "Squats (4x12)",
        "Deadlift or Hip Thrust (4x10-12)",
        "Dumbbell Row / Pull-ups (3x10)",
        "Overhead Press (3x10)",
        "Plank (3x45 sec)",
        "Leg Raises (3x15)",
        "Russian Twists (3x20)",
      ],
      Saturday: ["OPTIONAL CARDIO", "BIKE / RUN / WALK"],
      Sunday: ["REST"],
    };

    function getTodayInfo() {
      const days = [
        "Sunday",
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday",
        "Saturday",
      ];
      const todayIndex = new Date().getDay();
      const today = days[todayIndex];
      const date = new Date().toISOString().split("T")[0];
      return { today, date };
    }

    function showTodayWorkout() {
      const { today } = getTodayInfo();
      const list = document.getElementById("exercise-list");
      list.innerHTML = "";
      workouts[today].forEach((ex) => {
        const li = document.createElement("li");
        li.textContent = ex;
        list.appendChild(li);
      });
    }

    async function loadWorkoutHistory() {
      const list = document.getElementById("history-list");
      const history = await window.dbAPI.getWorkouts();
      list.innerHTML = "";

      if (history.length === 0) {
        list.innerHTML = "<li>No workouts yet.</li>";
        return;
      }

      history.forEach((item) => {
        const li = document.createElement("li");
        li.textContent = `${item.date} (${item.day}) ‚Äì ${item.type}`;
        list.appendChild(li);
      });

      checkIfWorkoutDone(history);
    }

    function checkIfWorkoutDone(history) {
      const { today, date } = getTodayInfo();
      const alreadyDone = history.some((entry) => entry.date === date);

      const finishBtn = document.getElementById("finish-btn");
      const status = document.getElementById("completion-status");

      if (alreadyDone) {
        finishBtn.style.display = "none";
        status.textContent = "‚úÖ Completed!";
      } else {
        finishBtn.style.display = "inline-block";
        status.textContent = "";
      }
    }

    async function finishWorkout() {
      const { today, date } = getTodayInfo();
      const workoutType = workouts[today][0] || "Unknown";

      const history = await window.dbAPI.getWorkouts();
      const alreadyDone = history.some((entry) => entry.date === date);
      if (alreadyDone) return;

      await window.dbAPI.addWorkout({
        date,
        day: today,
        type: workoutType,
      });

      loadWorkoutHistory();
    }

    document.addEventListener("DOMContentLoaded", () => {
      showTodayWorkout();
      loadWorkoutHistory();
      document
        .getElementById("finish-btn")
        .addEventListener("click", finishWorkout);
    });
  </script>
</html>
